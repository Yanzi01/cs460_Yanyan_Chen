<html>
  <head>
    <style>
      body {
        background-color: black;
        margin: 0;
        overflow: hidden;
      }

      /* Instruction box (top-left corner) */
      #instructions {
        position: fixed;
        top: 10px;
        left: 10px;
        z-index: 9999;
        color: white;
        background: rgba(0, 0, 0, 0.5);
        padding: 10px 14px;
        font-family: Arial, sans-serif;
        font-size: 16px;
        border-radius: 6px;
        line-height: 1.4em;
      }
    </style>

    <script type="text/javascript" src="https://get.goXTK.com/xtk_edge.js"></script>
    <script src="loader.js"></script>

    <script>
      let isActive = false;
      let cubeid;
      let SELECTED_CUBE;

      window.onload = function () {

        // Setup renderer
        r = new X.renderer3D();
        r.init();

        // Create 11x11x11 cube cloud
        SIZE = 15;
        GAP = 15;

        for (var z = -5; z < 6; z++) {
          for (var y = -5; y < 6; y++) {
            for (var x = -5; x < 6; x++) {
              new_cube = new X.cube();
              new_cube.transform.translateX((SIZE + GAP) * x);
              new_cube.transform.translateY((SIZE + GAP) * y);
              new_cube.transform.translateZ((SIZE + GAP) * z);
              r.add(new_cube);
            }
          }
        }

        // Zoom out camera
        r.camera.position = [0, 0, 600];

        // Mouse move: pick cube under cursor
        r.interactor.onMouseMove = function (event) {
          cubeid = r.pick(event.offsetX, event.offsetY);

          if (cubeid != 0) {
            SELECTED_CUBE = r.get(cubeid);
          }
        };

        // Keyboard controls
        window.onkeypress = function (e) {
          if (!SELECTED_CUBE) return;

          if (e.key == "q") {
            SELECTED_CUBE.visible = false;
          }
          if (e.key == "e") {
            SELECTED_CUBE.transform.rotateX(10);
          }
          if (e.key == "w") {
            SELECTED_CUBE.color = [
              Math.random(),
              Math.random(),
              Math.random()
            ];
          }
          if (e.key == "b") {
            isActive = !isActive;
          }
          if (e.key == "o") {
            download();
          }
          if (e.key == "l") {
            upload("scene.json");
          }
        };

        // Render loop
        r.onRender = function () {
          if (isActive == true && cubeid != 0) {
            r.camera.rotate([1, 0]); // spin camera
          }
        };

        r.render();
      };
    </script>
  </head>

  <body>
    <!-- Instruction box -->
    <div id="instructions">
  <b>Controls:</b><br>
  Hover the mouse over a cube<br>
  Then:<br>
  1. Press <b>Q</b> to erase the cube<br>
  2. Press <b>E</b> to rotate the cube<br>
  3. Press <b>W</b> to randomize its color<br>
  <br>
  Other controls (no hover needed):<br>
  Press <b>B</b> to toggle camera spin<br>
  Press <b>O</b> to save the scene<br>
  Press <b>L</b> to load the scene<br>
</div>
  </body>
</html>